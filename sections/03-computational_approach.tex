\section{Computational approach}

%\subsection{\label{sec:rwa}The rotating-wave approximation}

Models of isolated \qds{} or \qd{} ensembles in which the separation between dots far exceeds a typical interaction length (perhaps through a finite-difference time-domain grid) often use a rotating-wave approximation to great effect in eliminating high-frequency terms in the solution to \cref{eq:liouville} with only a small change in the resulting dynamics.
Assuming the incident radiation takes the form $\vb{E}(t) = \tilde{\vb{E}}(t) \cos(\omega_L t)$
where $\tilde{\vb{E}}(t)$ represents a slowly-varying envelope function, we introduce a unitary transformation $\tilde{\rho} = \hat{U} \hat{\rho} \hat{U}^\dagger$ where $\hat{U} = \mathrm{diag}(1, e^{i \omega_L t})$ to transform \cref{eq:liouville} into a rotating frame,
\begin{equation}
  i \hbar \pdv{\tilde{\rho}}{t} = \commutator{\hat{U} \hat{\mathcal{H}} \hat{U}^\dagger - i \hbar \hat{V}}{\tilde{\rho}} - \hat{\mathcal{D}}\qty[\tilde{\rho}], \quad \hat{V} \equiv \hat{U} \pdv{\hat{U}^\dagger}{t},
  \label{eq:rotating liouville}
\end{equation}
motivating $\hat{U} \hat{\mathcal{H}} \hat{U}^\dagger - i \hbar \hat{V} \equiv \tilde{\mathcal{H}}$ as a ``rotating-frame Hamiltonian.''
By neglecting the $e^{i \qty(\omega_0 + \omega_L) t}$ terms under the assumption that they oscillate quickly and will therefore integrate to zero over any appreciable timescales, we produce a governing equation much more amenable to numerical integration as it contains only smooth (low-frequency) quantities.

A similar transformation applies to the source distribution in \cref{eq:total field}.
Writing $\vb{P}(\vb{r}, t) = \tilde{\vb{P}}(\vb{r}, t)e^{i \omega_L t}$, the radiated field envelope becomes
\begin{widetext}
\begin{equation}
  \begin{gathered}
    \tilde{\vb{E}}_\text{rad}(\vb{r}, t) = -\frac{1}{4\pi \varepsilon} \int
    \qty(\tensor{\mathrm{I}} -  \bar{\vb{r}}\bar{\vb{r}}^\dagger) \cdot \frac{\qty(\partial_t^2 \tilde{\vb{P}}(\vb{r}', t_R) + 2 i \omega_L \partial_t \tilde{\vb{P}}(\vb{r}', t_R) - \omega_L^2 \tilde{\vb{P}}(\vb{r}', t_R)) e^{-i \omega_L \abs{\vb{r} - \vb{r}'}/c}}{c^2 \abs{\vb{r}-\vb{r}'}} + \\
    \qty(\tensor{\mathrm{I}} - 3\bar{\vb{r}}\bar{\vb{r}}^\dagger) \cdot \frac{\qty(\partial_t \tilde{\vb{P}}(\vb{r}', t_R) + i \omega_L \tilde{\vb{P}}(\vb{r}', t_R))e^{-i \omega_L \abs{\vb{r} - \vb{r}'}/c}}{c \abs{\vb{r}-\vb{r}'}^2} +
    \qty(\tensor{\mathrm{I}} - 3\bar{\vb{r}}\bar{\vb{r}}^\dagger) \cdot \frac{                \tilde{\vb{P}}(\vb{r}', t_R) e^{-i \omega_L \abs{\vb{r} - \vb{r}'}/c}}{\abs{\vb{r}-\vb{r}'}^3}
    \, \dd[3]{\vb{r'}}.
  \end{gathered}
  \label{eq:radiated envelope}
\end{equation}
\end{widetext}
where $\bar{\vb{r}} \equiv \qty(\vb{r} - \vb{r}')/\abs{\vb{r} - \vb{r}'}$ and $t_R \equiv t - \abs{\vb{r} - \vb{r}'}/c$.
Critically, \cref{eq:radiated envelope} maintains the phase relationship between every pair of \qds{} for arbitrarily large timesteps via the $e^{-i \omega_L \abs{\vb{r} - \vb{r}'}/c}$ factors that appear.
Without this transformation, the evolution of \cref{eq:liouville} would require $c \, \Delta t$ at least as small as the minimum separation between \qds{}---roughly three orders of magnitude smaller than the $\Delta t$ required to resolve the maximum frequency in \cref{eq:rotating liouville}.

%\subsection{Solution of the Liouville equation}

Solving \cref{eq:liouville} for each of $n_s$ \qds{} amounts to solving $n_s$ implicitly coupled first-order differential equations in time.
Due to its extreme accuracy and inherent bandlimitedness, we instead make use of the highly-tuned predictor/corrector scheme detailed in~\cite{Glaser2009} to numerically solve \cref{eq:liouville} for each \qd{} in the system.
Approximating $\hat{\rho}_i(t)$ as a weighted sum of complex exponentials, the predictor/corrector scheme proceeds with an extrapolation predictor step,
\begin{equation}
  \hat{\rho}_i(t_{k + 1}) \coloneqq \sum_{\ell = 1}^k \mathcal{P}_\ell^{\qty(0)} \hat{\rho}_i(t_\ell) + \mathcal{P}_\ell^{\qty(1)} \dot{\hat{\rho}}_i(t_\ell),
  \label{eq:predictor}
\end{equation}
and several iterated corrector steps,
\begin{equation}
  \hat{\rho}_i(t_{k + 1}) \coloneqq \mathcal{C}_{k+1}^{\qty(1)} \dot{\hat{\rho}}_i(t_{k + 1}) + \sum_{\ell = 1}^k \mathcal{C}_\ell^{\qty(0)} \hat{\rho}_i(t_i) + \mathcal{C}_\ell^{\qty(1)} \dot{\hat{\rho}}_i(t_\ell).
  \label{eq:corrector}
\end{equation}
where the $\mathcal{P}_\ell^{\qty(0, 1)}$ and $\mathcal{C}_\ell^{\qty(0, 1)}$ coefficients arise from a least-squares solution to a system of complex-valued exponentials on a semidisk in the left complex plane.

The approximation used in \cref{eq:rotating liouville} facilitates large timesteps that encompass many \qds{}.
These dots interact continuously over each timestep, thus a suitable integrator should accommodate multiple scattering events occurring within the same time interval---a feat accomplished naturally through iterated applications of \cref{eq:corrector}.
Moreover, the coupling term in \cref{eq:hamiltonian} and the retardation factor in \cref{eq:total field} add significant complexities, making ``straightforward'' solution methods (such as RK4 or other midstep methods) ill-suited for the problem at hand.
The necessity of a midstep RHS evaluation in RK4 schemes, for instance, proves troublesome; as the RHS to evaluate a given $\dot{\hat{\rho}}_i$ between timesteps depends on every other $\hat{\rho}_j$ at the same timepoint, the system requires either an infinite number of step subdivisions or some sort of extrapolation scheme to advance by $\Delta t$.
As the predictor/corrector method presented here possesses superior accuracy properties alongside a rigorous extrapolation scheme (by construction), it very naturally solves the system described by \cref{eq:rotating liouville,eq:radiated envelope}.

%\subsection{Evaluation of radiated fields}
\begin{figure}
  \input{figures/interpolation_window.tex}
  \caption{\label{fig:interpolation}Illustration of interpolation with four basis polynomials.
    An assumed signal takes $1.5\Delta t$ to travel from between points.
    Evaluations of the basis polynomials (and their derivatives) need only occur once between each pair of points (red dots) due to their translational invariance.
    The interpolated signal then becomes a sum of these values weighted by the known samples (black dots).
  }
\end{figure}

To evaluate \cref{eq:radiated envelope} between every pair of points we make use of variable-order Lagrange interpolation scheme.
Such a scheme easily accommodates both retardation effects between \qds{} separated by a non-integer number of timesteps as well as the first and second time derivatives of $\vb{P}$.
To make the interpolation calculation as efficient as possible at each timestep, we store only an history index (integer) and several interpolation coefficients (complex doubles) for every pair of \qds{}.
The history index corresponds to $\lfloor \abs{\Delta \vb{r}}/(c \, \Delta t) \rfloor$ and gives the start of the ``interpolation window'' used to reconstruct $\tilde{E}$ (\cref{fig:interpolation}).
The interpolation coefficients hold $\vb{d}_i \cdot \tilde{\vb{E}}_\text{rad} \cdot \vb{d}_j$ for an interpolatory representation of the integrand in \cref{eq:radiated envelope} (i.e.\ $\tilde{\vb{P}}$ becomes the basis polynomials evaluated at the correct time and contains none of the system dynamcis).
