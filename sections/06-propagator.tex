\section{Derivation of \cref{eq:integral operator}}

For time-harmonic (monochromatic) electric fields, we require
\begin{equation}
  \vb{E}_\omega = - \frac{1}{c} \qty(i \omega \vb{A}_\omega) - \grad \phi_\omega
  \label{eq:potential e-field}
\end{equation}
where $G_\omega(\vb{r} - \vb{r}') = e^{i k \abs{\vb{r} - \vb{r}'}}/\abs{\vb{r} - \vb{r}'}$ and
\begin{subequations}
  \begin{align}
      \phi_\omega(\vb{r}) &= \int \! G(\vb{r} - \vb{r}') \rho_\omega(\vb{r}') \dd[3]{\vb{r}'} \label{eq:scalar potential} \\
    \vb{A}_\omega(\vb{r}) &= \frac{1}{c} \int \! G(\vb{r} - \vb{r}') \vb{J}_\omega(\vb{r}') \dd[3]{\vb{r}'}. \label{eq:vector potential}
  \end{align}
\end{subequations}
Choosing a Lorentz gauge, i.e.\
\begin{equation}
  \div{\vb{A}_\omega} + \frac{1}{c} \qty(i \omega \phi_\omega) = 0
\end{equation}
and inserting \cref{eq:vector potential}, we may rewrite \cref{eq:potential e-field} as
\begin{widetext}
\begin{equation}
  \vb{E}_\omega(\vb{r}) = -\frac{i \omega}{c^2} \int \! G_\omega(\vb{r} - \vb{r}') \vb{J}_\omega(\vb{r}') \dd[3]{\vb{r}'} + \frac{1}{i \omega} \grad \qty( \div \int \! G_\omega(\vb{r} - \vb{r}') \vb{J}_\omega(\vb{r}') \dd[3]{\vb{r}'} ).
  \label{eq:e in terms of j}
\end{equation}
\end{widetext}
As $\vb{r}$ does not lie within the source region, the derivatives commute with the integral in the second term of \cref{eq:e in terms of j}.
Noting that
\begin{equation}
  \div \qty\Big(G_\omega(\vb{r} - \vb{r}') \vb{J}_\omega(\vb{r}')) =\grad{G_\omega(\vb{r} - \vb{r}')} \cdot \vb{J}_\omega(\vb{r}')
\end{equation}
as $\vb{J}_\omega(\vb{r}')$ is not a function of $\vb{r}$, we may compactly write \cref{eq:e in terms of j} as
\begin{equation}
  \vb{E}_\omega(\vb{r}) = -\frac{i \omega}{c^2} \int \! \tensor{\mathrm{G}}_d(\vb{r} - \vb{r}') \cdot \vb{J}_\omega(\vb{r}') \dd[3]{\vb{r}'}
  \label{eq:frequency domain dyadic green function}
\end{equation}
where
\begin{equation}
  \tensor{\mathrm{G}}_d(\vb{r}) = \qty[\tensor{\mathrm{I}} + \frac{\grad \grad}{k^2}]G_\omega(\vb{r}).
\end{equation}
Recalling $\grad{\bar{\vb{r}}} = \qty(\tensor{\mathrm{I}} - \outerprod{\bar{\vb{r}}}{\bar{\vb{r}}})/r$,
\begin{equation}
  \begin{aligned}
    \tensor{\mathrm{G}}_d(\vb{r}) &= \qty(\tensor{\mathrm{I}} - \outerprod{\bar{\vb{r}}}{\bar{\vb{r}}}) G_\omega(\vb{r}) \\
                                  &- \qty(\frac{i}{k r} + \frac{1}{(k r)^2} ) \qty(\tensor{\mathrm{I}} - 3 \outerprod{\bar{\vb{r}}}{\bar{\vb{r}}}) G_\omega(\vb{r})
  \end{aligned}
\end{equation}
